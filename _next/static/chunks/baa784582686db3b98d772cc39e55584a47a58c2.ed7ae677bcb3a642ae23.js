(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[2],{kgIS:function(t,r,e){"use strict";e.r(r),e.d(r,"storage",(function(){return o})),e.d(r,"db",(function(){return u}));var n=e("qfCH"),o=new n.InMemoryChunkStorage,i=new n.Space({id:"space",name:"a1",refs:{todos:null}});o.createSpace(i);var u=new n.ChunkDB({storage:o,collections:{todos:{}},spaces:["space"]})},pJ58:function(t,r,e){"use strict";e.r(r),e.d(r,"v1",(function(){return d})),e.d(r,"v3",(function(){return E})),e.d(r,"v4",(function(){return x})),e.d(r,"v5",(function(){return I})),e.d(r,"NIL",(function(){return O})),e.d(r,"version",(function(){return L})),e.d(r,"validate",(function(){return c})),e.d(r,"stringify",(function(){return l})),e.d(r,"parse",(function(){return y}));var n="undefined"!==typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!==typeof msCrypto&&"function"===typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto),o=new Uint8Array(16);function i(){if(!n)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return n(o)}var u=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;for(var c=function(t){return"string"===typeof t&&u.test(t)},s=[],a=0;a<256;++a)s.push((a+256).toString(16).substr(1));var f,h,l=function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,e=(s[t[r+0]]+s[t[r+1]]+s[t[r+2]]+s[t[r+3]]+"-"+s[t[r+4]]+s[t[r+5]]+"-"+s[t[r+6]]+s[t[r+7]]+"-"+s[t[r+8]]+s[t[r+9]]+"-"+s[t[r+10]]+s[t[r+11]]+s[t[r+12]]+s[t[r+13]]+s[t[r+14]]+s[t[r+15]]).toLowerCase();if(!c(e))throw TypeError("Stringified UUID is invalid");return e},p=0,v=0;var d=function(t,r,e){var n=r&&e||0,o=r||new Array(16),u=(t=t||{}).node||f,c=void 0!==t.clockseq?t.clockseq:h;if(null==u||null==c){var s=t.random||(t.rng||i)();null==u&&(u=f=[1|s[0],s[1],s[2],s[3],s[4],s[5]]),null==c&&(c=h=16383&(s[6]<<8|s[7]))}var a=void 0!==t.msecs?t.msecs:Date.now(),d=void 0!==t.nsecs?t.nsecs:v+1,y=a-p+(d-v)/1e4;if(y<0&&void 0===t.clockseq&&(c=c+1&16383),(y<0||a>p)&&void 0===t.nsecs&&(d=0),d>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");p=a,v=d,h=c;var m=(1e4*(268435455&(a+=122192928e5))+d)%4294967296;o[n++]=m>>>24&255,o[n++]=m>>>16&255,o[n++]=m>>>8&255,o[n++]=255&m;var g=a/4294967296*1e4&268435455;o[n++]=g>>>8&255,o[n++]=255&g,o[n++]=g>>>24&15|16,o[n++]=g>>>16&255,o[n++]=c>>>8|128,o[n++]=255&c;for(var w=0;w<6;++w)o[n+w]=u[w];return r||l(o)};var y=function(t){if(!c(t))throw TypeError("Invalid UUID");var r,e=new Uint8Array(16);return e[0]=(r=parseInt(t.slice(0,8),16))>>>24,e[1]=r>>>16&255,e[2]=r>>>8&255,e[3]=255&r,e[4]=(r=parseInt(t.slice(9,13),16))>>>8,e[5]=255&r,e[6]=(r=parseInt(t.slice(14,18),16))>>>8,e[7]=255&r,e[8]=(r=parseInt(t.slice(19,23),16))>>>8,e[9]=255&r,e[10]=(r=parseInt(t.slice(24,36),16))/1099511627776&255,e[11]=r/4294967296&255,e[12]=r>>>24&255,e[13]=r>>>16&255,e[14]=r>>>8&255,e[15]=255&r,e};var m=function(t,r,e){function n(t,n,o,i){if("string"===typeof t&&(t=function(t){t=unescape(encodeURIComponent(t));for(var r=[],e=0;e<t.length;++e)r.push(t.charCodeAt(e));return r}(t)),"string"===typeof n&&(n=y(n)),16!==n.length)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");var u=new Uint8Array(16+t.length);if(u.set(n),u.set(t,n.length),(u=e(u))[6]=15&u[6]|r,u[8]=63&u[8]|128,o){i=i||0;for(var c=0;c<16;++c)o[i+c]=u[c];return o}return l(u)}try{n.name=t}catch(o){}return n.DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8",n.URL="6ba7b811-9dad-11d1-80b4-00c04fd430c8",n};function g(t){return 14+(t+64>>>9<<4)+1}function w(t,r){var e=(65535&t)+(65535&r);return(t>>16)+(r>>16)+(e>>16)<<16|65535&e}function b(t,r,e,n,o,i){return w((u=w(w(r,t),w(n,i)))<<(c=o)|u>>>32-c,e);var u,c}function k(t,r,e,n,o,i,u){return b(r&e|~r&n,t,r,o,i,u)}function P(t,r,e,n,o,i,u){return b(r&n|e&~n,t,r,o,i,u)}function S(t,r,e,n,o,i,u){return b(r^e^n,t,r,o,i,u)}function j(t,r,e,n,o,i,u){return b(e^(r|~n),t,r,o,i,u)}var E=m("v3",48,(function(t){if("string"===typeof t){var r=unescape(encodeURIComponent(t));t=new Uint8Array(r.length);for(var e=0;e<r.length;++e)t[e]=r.charCodeAt(e)}return function(t){for(var r=[],e=32*t.length,n="0123456789abcdef",o=0;o<e;o+=8){var i=t[o>>5]>>>o%32&255,u=parseInt(n.charAt(i>>>4&15)+n.charAt(15&i),16);r.push(u)}return r}(function(t,r){t[r>>5]|=128<<r%32,t[g(r)-1]=r;for(var e=1732584193,n=-271733879,o=-1732584194,i=271733878,u=0;u<t.length;u+=16){var c=e,s=n,a=o,f=i;e=k(e,n,o,i,t[u],7,-680876936),i=k(i,e,n,o,t[u+1],12,-389564586),o=k(o,i,e,n,t[u+2],17,606105819),n=k(n,o,i,e,t[u+3],22,-1044525330),e=k(e,n,o,i,t[u+4],7,-176418897),i=k(i,e,n,o,t[u+5],12,1200080426),o=k(o,i,e,n,t[u+6],17,-1473231341),n=k(n,o,i,e,t[u+7],22,-45705983),e=k(e,n,o,i,t[u+8],7,1770035416),i=k(i,e,n,o,t[u+9],12,-1958414417),o=k(o,i,e,n,t[u+10],17,-42063),n=k(n,o,i,e,t[u+11],22,-1990404162),e=k(e,n,o,i,t[u+12],7,1804603682),i=k(i,e,n,o,t[u+13],12,-40341101),o=k(o,i,e,n,t[u+14],17,-1502002290),e=P(e,n=k(n,o,i,e,t[u+15],22,1236535329),o,i,t[u+1],5,-165796510),i=P(i,e,n,o,t[u+6],9,-1069501632),o=P(o,i,e,n,t[u+11],14,643717713),n=P(n,o,i,e,t[u],20,-373897302),e=P(e,n,o,i,t[u+5],5,-701558691),i=P(i,e,n,o,t[u+10],9,38016083),o=P(o,i,e,n,t[u+15],14,-660478335),n=P(n,o,i,e,t[u+4],20,-405537848),e=P(e,n,o,i,t[u+9],5,568446438),i=P(i,e,n,o,t[u+14],9,-1019803690),o=P(o,i,e,n,t[u+3],14,-187363961),n=P(n,o,i,e,t[u+8],20,1163531501),e=P(e,n,o,i,t[u+13],5,-1444681467),i=P(i,e,n,o,t[u+2],9,-51403784),o=P(o,i,e,n,t[u+7],14,1735328473),e=S(e,n=P(n,o,i,e,t[u+12],20,-1926607734),o,i,t[u+5],4,-378558),i=S(i,e,n,o,t[u+8],11,-2022574463),o=S(o,i,e,n,t[u+11],16,1839030562),n=S(n,o,i,e,t[u+14],23,-35309556),e=S(e,n,o,i,t[u+1],4,-1530992060),i=S(i,e,n,o,t[u+4],11,1272893353),o=S(o,i,e,n,t[u+7],16,-155497632),n=S(n,o,i,e,t[u+10],23,-1094730640),e=S(e,n,o,i,t[u+13],4,681279174),i=S(i,e,n,o,t[u],11,-358537222),o=S(o,i,e,n,t[u+3],16,-722521979),n=S(n,o,i,e,t[u+6],23,76029189),e=S(e,n,o,i,t[u+9],4,-640364487),i=S(i,e,n,o,t[u+12],11,-421815835),o=S(o,i,e,n,t[u+15],16,530742520),e=j(e,n=S(n,o,i,e,t[u+2],23,-995338651),o,i,t[u],6,-198630844),i=j(i,e,n,o,t[u+7],10,1126891415),o=j(o,i,e,n,t[u+14],15,-1416354905),n=j(n,o,i,e,t[u+5],21,-57434055),e=j(e,n,o,i,t[u+12],6,1700485571),i=j(i,e,n,o,t[u+3],10,-1894986606),o=j(o,i,e,n,t[u+10],15,-1051523),n=j(n,o,i,e,t[u+1],21,-2054922799),e=j(e,n,o,i,t[u+8],6,1873313359),i=j(i,e,n,o,t[u+15],10,-30611744),o=j(o,i,e,n,t[u+6],15,-1560198380),n=j(n,o,i,e,t[u+13],21,1309151649),e=j(e,n,o,i,t[u+4],6,-145523070),i=j(i,e,n,o,t[u+11],10,-1120210379),o=j(o,i,e,n,t[u+2],15,718787259),n=j(n,o,i,e,t[u+9],21,-343485551),e=w(e,c),n=w(n,s),o=w(o,a),i=w(i,f)}return[e,n,o,i]}(function(t){if(0===t.length)return[];for(var r=8*t.length,e=new Uint32Array(g(r)),n=0;n<r;n+=8)e[n>>5]|=(255&t[n/8])<<n%32;return e}(t),8*t.length))}));var x=function(t,r,e){var n=(t=t||{}).random||(t.rng||i)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,r){e=e||0;for(var o=0;o<16;++o)r[e+o]=n[o];return r}return l(n)};function _(t,r,e,n){switch(t){case 0:return r&e^~r&n;case 1:return r^e^n;case 2:return r&e^r&n^e&n;case 3:return r^e^n}}function C(t,r){return t<<r|t>>>32-r}var I=m("v5",80,(function(t){var r=[1518500249,1859775393,2400959708,3395469782],e=[1732584193,4023233417,2562383102,271733878,3285377520];if("string"===typeof t){var n=unescape(encodeURIComponent(t));t=[];for(var o=0;o<n.length;++o)t.push(n.charCodeAt(o))}else Array.isArray(t)||(t=Array.prototype.slice.call(t));t.push(128);for(var i=t.length/4+2,u=Math.ceil(i/16),c=new Array(u),s=0;s<u;++s){for(var a=new Uint32Array(16),f=0;f<16;++f)a[f]=t[64*s+4*f]<<24|t[64*s+4*f+1]<<16|t[64*s+4*f+2]<<8|t[64*s+4*f+3];c[s]=a}c[u-1][14]=8*(t.length-1)/Math.pow(2,32),c[u-1][14]=Math.floor(c[u-1][14]),c[u-1][15]=8*(t.length-1)&4294967295;for(var h=0;h<u;++h){for(var l=new Uint32Array(80),p=0;p<16;++p)l[p]=c[h][p];for(var v=16;v<80;++v)l[v]=C(l[v-3]^l[v-8]^l[v-14]^l[v-16],1);for(var d=e[0],y=e[1],m=e[2],g=e[3],w=e[4],b=0;b<80;++b){var k=Math.floor(b/20),P=C(d,5)+_(k,y,m,g)+w+r[k]+l[b]>>>0;w=g,g=m,m=C(y,30)>>>0,y=d,d=P}e[0]=e[0]+d>>>0,e[1]=e[1]+y>>>0,e[2]=e[2]+m>>>0,e[3]=e[3]+g>>>0,e[4]=e[4]+w>>>0}return[e[0]>>24&255,e[0]>>16&255,e[0]>>8&255,255&e[0],e[1]>>24&255,e[1]>>16&255,e[1]>>8&255,255&e[1],e[2]>>24&255,e[2]>>16&255,e[2]>>8&255,255&e[2],e[3]>>24&255,e[3]>>16&255,e[3]>>8&255,255&e[3],e[4]>>24&255,e[4]>>16&255,e[4]>>8&255,255&e[4]]})),O="00000000-0000-0000-0000-000000000000";var L=function(t){if(!c(t))throw TypeError("Invalid UUID");return parseInt(t.substr(14,1),16)}},qfCH:function(t,r,e){var n,o=e("pJ58");function i(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function u(t,r,e){return r&&i(t.prototype,r),e&&i(t,e),t}function c(){return(c=Object.assign||function(t){for(var r=1;r<arguments.length;r++){var e=arguments[r];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}return t}).apply(this,arguments)}function s(t,r){t.prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r}function a(t){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function f(t,r){return(f=Object.setPrototypeOf||function(t,r){return t.__proto__=r,t})(t,r)}function h(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function l(t,r,e){return(l=h()?Reflect.construct:function(t,r,e){var n=[null];n.push.apply(n,r);var o=new(Function.bind.apply(t,n));return e&&f(o,e.prototype),o}).apply(null,arguments)}function p(t){var r="function"===typeof Map?new Map:void 0;return(p=function(t){if(null===t||(e=t,-1===Function.toString.call(e).indexOf("[native code]")))return t;var e;if("function"!==typeof t)throw new TypeError("Super expression must either be null or a function");if("undefined"!==typeof r){if(r.has(t))return r.get(t);r.set(t,n)}function n(){return l(t,arguments,a(this).constructor)}return n.prototype=Object.create(t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),f(n,t)})(t)}function v(t){return Array.from(t.values())}function d(t){var r={};return t.forEach((function(t){return r[t._id]=t})),r}!function(t){t.Unknown="",t.Snapshot="snapshot",t.Incremental="incremental",t.Update="update",t.Merge="merge",t.Draft="draft",t.TemporaryTransaction="temporary-transaction"}(n||(n={}));var y=function(){function t(t){this.id="",this.id=t.id,this.parents=t.parents,this.records=function(t){return new Map(Object.keys(t).map((function(r){return[r,t[r]]})))}(t.records)}return t.prototype.toGenericChunk=function(){var t={};return this.records.forEach((function(r,e){return t[e]=r})),{id:this.id,type:this.type,parents:this.parents.slice(),records:t}},t}(),m=function(t){function r(r){var e;if((e=t.call(this,r)||this).type=n.Incremental,!e.records.size)throw new Error("Incremental chunk can not be empty");return e}return s(r,t),r}(y),g=function(t){function r(r){var e;return(e=t.call(this,r)||this).type=n.Snapshot,e}return s(r,t),r}(y);function w(t){if(!function(t){if("object"!==typeof t||!t)return!1;var r=t.parents,e=t.records;return!!Array.isArray(r)&&"object"===typeof e}(t))throw new Error("Invalid chunk");switch(t.type){case n.Snapshot:return new g(t);case n.TemporaryTransaction:case n.Incremental:default:return new m(t)}}var b=function(t){function r(){return t.apply(this,arguments)||this}return s(r,t),r}(p(Error)),k=function(t){function r(r){return t.call(this,'Space not found "'+r+'"')||this}return s(r,t),r}(b),P=function(t){function r(r){return t.call(this,'Chunk "'+r+'" not found in storage')||this}return s(r,t),r}(p(Error)),S=function(){function t(t){this.driver=t,this.chunks=new Map,this.spaces=new Map}var r=t.prototype;return r.getExists=function(t){return this.chunks.get(t)||null},r.saveChunk=function(t){try{return this.chunks.set(t.id,t),Promise.resolve(this.driver.saveChunk(t.toGenericChunk())).then((function(){return t}))}catch(r){return Promise.reject(r)}},r.loadChunk=function(t){try{var r=this;if(!t)throw new P(t);return r.chunks.has(t)?Promise.resolve(r.chunks.get(t)):Promise.resolve(r.driver.loadChunk(t)).then((function(t){var e=w(t);return r.chunks.set(e.id,e),e}))}catch(e){return Promise.reject(e)}},r.saveSpace=function(t){return this.spaces.set(t.id,t),this.driver.saveSpace(t)},r.loadSpace=function(t){try{return Promise.resolve(this.driver.loadSpace(t)).then((function(r){if(!r)throw new b('Space "'+t+'" not found');return r}))}catch(r){return Promise.reject(r)}},t}();function j(t,r,e){if(!t.s){if(e instanceof E){if(!e.s)return void(e.o=j.bind(null,t,r));1&r&&(r=e.s),e=e.v}if(e&&e.then)return void e.then(j.bind(null,t,r),j.bind(null,t,2));t.s=r,t.v=e;var n=t.o;n&&n(t)}}var E=function(){function t(){}return t.prototype.then=function(r,e){var n=new t,o=this.s;if(o){var i=1&o?r:e;if(i){try{j(n,1,i(this.v))}catch(u){j(n,2,u)}return n}return this}return this.o=function(t){try{var o=t.v;1&t.s?j(n,1,r?r(o):o):e?j(n,1,e(o)):j(n,2,o)}catch(u){j(n,2,u)}},n},t}();function x(t){return t instanceof E&&1&t.s}function _(t,r,e){for(var n;;){var o=t();if(x(o)&&(o=o.v),!o)return i;if(o.then){n=0;break}var i=e();if(i&&i.then){if(!x(i)){n=1;break}i=i.s}if(r){var u=r();if(u&&u.then&&!x(u)){n=2;break}}}var c=new E,s=j.bind(null,c,2);return(0===n?o.then(f):1===n?i.then(a):u.then(h)).then(void 0,s),c;function a(n){i=n;do{if(r&&(u=r())&&u.then&&!x(u))return void u.then(h).then(void 0,s);if(!(o=t())||x(o)&&!o.v)return void j(c,1,i);if(o.then)return void o.then(f).then(void 0,s);x(i=e())&&(i=i.v)}while(!i||!i.then);i.then(a).then(void 0,s)}function f(t){t?(i=e())&&i.then?i.then(a).then(void 0,s):a(i):j(c,1,i)}function h(){(o=t())?o.then?o.then(f).then(void 0,s):f(o):j(c,1,i)}}var C=function(){function t(t){this.querySelector=t,this._done=!1}var r=t.prototype;return r.one=function(){try{var t=function(){return r._done=!0,e},r=this,e=null,n=_((function(){return!r.querySelector.done||!e}),void 0,(function(){return Promise.resolve(r.querySelector.next()).then((function(t){var r=t.records;e=r[0]||null}))}));return Promise.resolve(n&&n.then?n.then(t):t())}catch(o){return Promise.reject(o)}},r.all=function(){try{var t=function(){return r._done=!0,e},r=this;if(r._done)throw new Error("Cursor already complete");var e=[],n=_((function(){return!r.querySelector.done}),void 0,(function(){return Promise.resolve(r.querySelector.next()).then((function(t){var r=t.records;e.push.apply(e,r)}))}));return Promise.resolve(n&&n.then?n.then(t):t())}catch(o){return Promise.reject(o)}},r.reduce=function(t,r){try{var e=function(){return n._done=!0,o},n=this;if(n._done)throw new Error("Cursor already complete");var o=r,i=_((function(){return!n.querySelector.done}),void 0,(function(){return Promise.resolve(n.querySelector.next()).then((function(r){r.records.forEach((function(r){return o=t(o,r)}))}))}));return Promise.resolve(i&&i.then?i.then(e):e())}catch(u){return Promise.reject(u)}},u(t,[{key:"done",get:function(){return this._done}}]),t}();!function(t,r,e){t(e={path:r,exports:{},require:function(t,r){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}()}},e.exports)}((function(t){var r=function(t){var r,e=Object.prototype,n=e.hasOwnProperty,o="function"===typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",u=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function s(t,r,e){return Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}),t[r]}try{s({},"")}catch(L){s=function(t,r,e){return t[r]=e}}function a(t,r,e,n){var o=r&&r.prototype instanceof y?r:y,i=Object.create(o.prototype),u=new C(n||[]);return i._invoke=function(t,r,e){var n=h;return function(o,i){if(n===p)throw new Error("Generator is already running");if(n===v){if("throw"===o)throw i;return O()}for(e.method=o,e.arg=i;;){var u=e.delegate;if(u){var c=E(u,e);if(c){if(c===d)continue;return c}}if("next"===e.method)e.sent=e._sent=e.arg;else if("throw"===e.method){if(n===h)throw n=v,e.arg;e.dispatchException(e.arg)}else"return"===e.method&&e.abrupt("return",e.arg);n=p;var s=f(t,r,e);if("normal"===s.type){if(n=e.done?v:l,s.arg===d)continue;return{value:s.arg,done:e.done}}"throw"===s.type&&(n=v,e.method="throw",e.arg=s.arg)}}}(t,e,u),i}function f(t,r,e){try{return{type:"normal",arg:t.call(r,e)}}catch(L){return{type:"throw",arg:L}}}t.wrap=a;var h="suspendedStart",l="suspendedYield",p="executing",v="completed",d={};function y(){}function m(){}function g(){}var w={};w[i]=function(){return this};var b=Object.getPrototypeOf,k=b&&b(b(I([])));k&&k!==e&&n.call(k,i)&&(w=k);var P=g.prototype=y.prototype=Object.create(w);function S(t){["next","throw","return"].forEach((function(r){s(t,r,(function(t){return this._invoke(r,t)}))}))}function j(t,r){function e(o,i,u,c){var s=f(t[o],t,i);if("throw"!==s.type){var a=s.arg,h=a.value;return h&&"object"===typeof h&&n.call(h,"__await")?r.resolve(h.__await).then((function(t){e("next",t,u,c)}),(function(t){e("throw",t,u,c)})):r.resolve(h).then((function(t){a.value=t,u(a)}),(function(t){return e("throw",t,u,c)}))}c(s.arg)}var o;this._invoke=function(t,n){function i(){return new r((function(r,o){e(t,n,r,o)}))}return o=o?o.then(i,i):i()}}function E(t,e){var n=t.iterator[e.method];if(n===r){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=r,E(t,e),"throw"===e.method))return d;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return d}var o=f(n,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,d;var i=o.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=r),e.delegate=null,d):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,d)}function x(t){var r={tryLoc:t[0]};1 in t&&(r.catchLoc=t[1]),2 in t&&(r.finallyLoc=t[2],r.afterLoc=t[3]),this.tryEntries.push(r)}function _(t){var r=t.completion||{};r.type="normal",delete r.arg,t.completion=r}function C(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(x,this),this.reset(!0)}function I(t){if(t){var e=t[i];if(e)return e.call(t);if("function"===typeof t.next)return t;if(!isNaN(t.length)){var o=-1,u=function e(){for(;++o<t.length;)if(n.call(t,o))return e.value=t[o],e.done=!1,e;return e.value=r,e.done=!0,e};return u.next=u}}return{next:O}}function O(){return{value:r,done:!0}}return m.prototype=P.constructor=g,g.constructor=m,m.displayName=s(g,c,"GeneratorFunction"),t.isGeneratorFunction=function(t){var r="function"===typeof t&&t.constructor;return!!r&&(r===m||"GeneratorFunction"===(r.displayName||r.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,s(t,c,"GeneratorFunction")),t.prototype=Object.create(P),t},t.awrap=function(t){return{__await:t}},S(j.prototype),j.prototype[u]=function(){return this},t.AsyncIterator=j,t.async=function(r,e,n,o,i){void 0===i&&(i=Promise);var u=new j(a(r,e,n,o),i);return t.isGeneratorFunction(e)?u:u.next().then((function(t){return t.done?t.value:u.next()}))},S(P),s(P,c,"Generator"),P[i]=function(){return this},P.toString=function(){return"[object Generator]"},t.keys=function(t){var r=[];for(var e in t)r.push(e);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=I,C.prototype={constructor:C,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=r,this.done=!1,this.delegate=null,this.method="next",this.arg=r,this.tryEntries.forEach(_),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=r)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function o(n,o){return c.type="throw",c.arg=t,e.next=n,o&&(e.method="next",e.arg=r),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var u=this.tryEntries[i],c=u.completion;if("root"===u.tryLoc)return o("end");if(u.tryLoc<=this.prev){var s=n.call(u,"catchLoc"),a=n.call(u,"finallyLoc");if(s&&a){if(this.prev<u.catchLoc)return o(u.catchLoc,!0);if(this.prev<u.finallyLoc)return o(u.finallyLoc)}else if(s){if(this.prev<u.catchLoc)return o(u.catchLoc,!0)}else{if(!a)throw new Error("try statement without catch or finally");if(this.prev<u.finallyLoc)return o(u.finallyLoc)}}}},abrupt:function(t,r){for(var e=this.tryEntries.length-1;e>=0;--e){var o=this.tryEntries[e];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=r&&r<=i.finallyLoc&&(i=null);var u=i?i.completion:{};return u.type=t,u.arg=r,i?(this.method="next",this.next=i.finallyLoc,d):this.complete(u)},complete:function(t,r){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&r&&(this.next=r),d},finish:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e.finallyLoc===t)return this.complete(e.completion,e.afterLoc),_(e),d}},catch:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e.tryLoc===t){var n=e.completion;if("throw"===n.type){var o=n.arg;_(e)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:I(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=r),d}},t}(t.exports);try{regeneratorRuntime=r}catch(e){Function("r","regeneratorRuntime = r")(r)}}));var I={$eq:function(t){return function(r){return r===t}},$gt:function(t){return function(r){return r>t}},$gte:function(t){return function(r){return r>=t}},$lt:function(t){return function(r){return r<t}},$lte:function(t){return function(r){return r<=t}}};function O(t){if("object"!==typeof t)throw new Error("ConditionValidator must be an object");var r=Object.keys(t).map((function(r){return{getter:function(t){var r=Array.isArray(t)?t:t.split(".");return function(t){for(var e=t,n=0;n<r.length;n++){if("object"!==typeof e||!e)return;var o=r[n];if(!(o in e))return;e=e[o]}return e}}(r),conditions:function(t){var r="object"===typeof t?t:{$eq:t};return Object.keys(r).map((function(t){var e=t;if(!(e in I))throw new L('Unknown operator "'+e+'"');return I[e](r[e])}))}(t[r])}}));return function(t){return r.every((function(r){var e=r.getter,n=r.conditions,o=e(t);return n.every((function(t){return t(o)}))}))}}var L=function(t){function r(r,e,n){var o;return(o=t.call(this,r)||this).path=e,o.query=n,o}return s(r,t),r}(p(Error)),A=Symbol("Call");function R(t){var r;return(r={})[A]=!0,r.action=t,r.args=[].slice.call(arguments,1),r}var T=function(t){try{return Promise.resolve(this.storage.loadChunk(t)).then((function(r){if(!r)throw new P(t);return r}))}catch(r){return Promise.reject(r)}},U=regeneratorRuntime.mark(q);function q(t,r){var e,o,i,u,c;return regeneratorRuntime.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:void 0===r&&(r={}),e=new Map,o=O(r),u=t;case 4:return s.next=7,R(T,u);case 7:if(i=s.sent){s.next=10;break}throw new P(u);case 10:c=v(i.records).filter(D(e,o)),s.t0=i.type,s.next=s.t0===n.Snapshot?14:s.t0===n.TemporaryTransaction||s.t0===n.Incremental?16:20;break;case 14:return s.abrupt("return",{chunkID:u,records:c});case 16:return s.next=18,{chunkID:u,records:c};case 18:return u=i.parents[0],s.abrupt("break",21);case 20:throw new Error('Unsupported chunk type "'+i.type+'"');case 21:s.next=4;break;case 23:case"end":return s.stop()}}),U)}function D(t,r){return function(e){return!t.has(e._id)&&(!!r(e)&&(t.set(e._id,e),!0))}}var M,N=function(){function t(t,r,e){this.db=t,this.chunkID=r,this.query=e,this._done=!1,this.scenario=this.db.run(q(this.chunkID,this.query))}return t.prototype.next=function(){try{var t=this;return Promise.resolve(t.scenario.next()).then((function(r){var e=r.done,n=r.value;return t._done=!!e,n}))}catch(r){return Promise.reject(r)}},u(t,[{key:"done",get:function(){return this._done}}]),t}(),F=function(){function t(t,r,e){this.db=t,this.chunkID=r,this._query=e}return t.prototype.exec=function(){var t=new N(this.db,this.chunkID,this._query);return new C(t)},t}(),G=function(){function t(t,r,e){if(this.db=t,this.refs=r,this.config=e,!r)throw new Error("Refs can not be null")}var r=t.prototype;return r.find=function(t){var r=this.refs[this.config.name];if(!r)throw new Error('Invalid ref "'+this.refs[this.config.name]+'" for '+this.config.name);return new F(this.db,r,t)},r.findOne=function(t){try{return Promise.resolve(this.findAll(t)).then((function(t){return t[0]||null}))}catch(r){return Promise.reject(r)}},r.findAll=function(t){return this.find(t).exec().all()},t}(),$=function(t){function r(r,e,o){var i;return void 0===o&&(o=[]),(i=t.call(this,{id:r,type:n.TemporaryTransaction,parents:e?[e]:[],records:d(o)})||this).type=n.TemporaryTransaction,i.records=new Map,i}return s(r,t),r}(y),V=function(){function t(t,r){this.db=t,this.space=r,this.updatedRefs={},this.stats={deleted:[],inserted:[],updated:[],upserted:[]},this.chunks={}}var r=t.prototype;return r.getDB=function(){return this.db},r.getSpace=function(){return this.space},r.getStats=function(){return this.stats},r.collection=function(t){return new G(this.db,this.refs,this.db.collections[t].config)},r.insert=function(t,r){try{var e=this;return e.writeIntoCollection(t),r._id||(r=c({},r,{_id:o.v4()})),e.chunks[t].records.set(r._id,r),e.stats.inserted.push(r._id),e.stats.upserted.push(r._id),e.db.storage.saveChunk(e.chunks[t]),Promise.resolve(r)}catch(n){return Promise.reject(n)}},r.upsert=function(t,r){try{var e=this;return e.writeIntoCollection(t),e.chunks[t].records.has(r._id)||e.stats.upserted.push(r._id),e.chunks[t].records.set(r._id,r),e.db.storage.saveChunk(e.chunks[t]),Promise.resolve(r)}catch(n){return Promise.reject(n)}},r.writeIntoCollection=function(t){if(!(t in this.updatedRefs)){var r=o.v4(),e=new $(r,this.refs[t]);this.updatedRefs[t]=r,this.chunks[t]=e}},u(t,[{key:"refs",get:function(){return c({},this.space.refs,this.updatedRefs)}}]),t}(),H=function(){function t(t,r,e){this.db=t,this.name=r,this.config=e}return t.prototype.space=function(t){var r=this.db.spaces.get(t);if(!r)throw new Error('Invalid space "'+t+'"');return new G(this.db,r.refs,this.config)},t}();(M=r.Priority||(r.Priority={}))[M.Low=1]="Low",M[M.Normal=2]="Normal",M[M.High=3]="High";var J=function(t,e){if(this.name=t,this.indexedFields=[],this.priority=r.Priority.Normal,this.indexedFields=e.indexedFields||this.indexedFields,this.priority=e.priority||this.priority,"factory"in e)this.factory=e.factory;else{if(!("constructor"in e))throw new Error("Invalid collection config");this.factory=function(t){return new e.constructor(t)}}},B=function(t){this.id=t.id,this.name=t.name,this.description=t.description||"",this.refs=t.refs},Y="undefined"!==typeof Symbol?Symbol.iterator||(Symbol.iterator=Symbol("Symbol.iterator")):"@@iterator";function z(t,r,e){if(!t.s){if(e instanceof K){if(!e.s)return void(e.o=z.bind(null,t,r));1&r&&(r=e.s),e=e.v}if(e&&e.then)return void e.then(z.bind(null,t,r),z.bind(null,t,2));t.s=r,t.v=e;var n=t.o;n&&n(t)}}var K=function(){function t(){}return t.prototype.then=function(r,e){var n=new t,o=this.s;if(o){var i=1&o?r:e;if(i){try{z(n,1,i(this.v))}catch(u){z(n,2,u)}return n}return this}return this.o=function(t){try{var o=t.v;1&t.s?z(n,1,r?r(o):o):e?z(n,1,e(o)):z(n,2,o)}catch(u){z(n,2,u)}},n},t}();function Q(t){return t instanceof K&&1&t.s}function W(t,r,e){if("function"===typeof t[Y]){var n,o,i,u=t[Y]();if(function t(c){try{for(;!(n=u.next()).done&&(!e||!e());)if((c=r(n.value))&&c.then){if(!Q(c))return void c.then(t,i||(i=z.bind(null,o=new K,2)));c=c.v}o?z(o,1,c):o=c}catch(s){z(o||(o=new K),2,s)}}(),u.return){var c=function(t){try{n.done||u.return()}catch(r){}return t};if(o&&o.then)return o.then(c,(function(t){throw c(t)}));c()}return o}if(!("length"in t))throw new TypeError("Object is not iterable");for(var s=[],a=0;a<t.length;a++)s.push(t[a]);return function(t,r,e){var n,o,i=-1;return function u(c){try{for(;++i<t.length&&(!e||!e());)if((c=r(i))&&c.then){if(!Q(c))return void c.then(u,o||(o=z.bind(null,n=new K,2)));c=c.v}n?z(n,1,c):n=c}catch(s){z(n||(n=new K),2,s)}}(),n}(s,(function(t){return r(s[t])}),e)}function X(t,r,e){for(var n;;){var o=t();if(Q(o)&&(o=o.v),!o)return i;if(o.then){n=0;break}var i=e();if(i&&i.then){if(!Q(i)){n=1;break}i=i.s}if(r){var u=r();if(u&&u.then&&!Q(u)){n=2;break}}}var c=new K,s=z.bind(null,c,2);return(0===n?o.then(f):1===n?i.then(a):u.then(h)).then(void 0,s),c;function a(n){i=n;do{if(r&&(u=r())&&u.then&&!Q(u))return void u.then(h).then(void 0,s);if(!(o=t())||Q(o)&&!o.v)return void z(c,1,i);if(o.then)return void o.then(f).then(void 0,s);Q(i=e())&&(i=i.v)}while(!i||!i.then);i.then(a).then(void 0,s)}function f(t){t?(i=e())&&i.then?i.then(a).then(void 0,s):a(i):z(c,1,i)}function h(){(o=t())?o.then?o.then(f).then(void 0,s):f(o):z(c,1,i)}}var Z=function(){function t(t){var r=this;this.spaces=new Map,this.ready=!1,this.activeTransactions=[],this.storeSubscriptions=[],this.spaceSubscriptions=new Map,this.collections={},Object.entries(t.collections).forEach((function(t){var e=t[0],n=t[1];r.collections[e]=new H(r,e,new J(e,n))})),this.storageDriver=t.storage,this.storage=new S(this.storageDriver);var e=[];t.spaces&&t.spaces.forEach((function(t){r.spaces.set(t,{id:t,description:"",name:"",refs:{}}),e.push(r.storage.loadSpace(t).then((function(e){return r.spaces.set(t,new B(e))})).then((function(){})))})),this.ready$=Promise.all(e).then((function(){r.ready=!0}))}var r=t.prototype;return r.subscribe=function(t,r){var e=this;if("function"===typeof t)return this.storeSubscriptions.push(t),function(){return e.storeSubscriptions=e.storeSubscriptions.filter((function(r){return r!==t}))};var n=this.spaceSubscriptions.get(t)||[];return n.push(r),this.spaceSubscriptions.set(t,n),function(){return e.spaceSubscriptions.set(t,n.filter((function(t){return t!==r})))}},r.collection=function(t){if(t in this.collections)return this.collections[t];throw new Error('Invalid collection "'+t+'"')},r.run=function(t){return function(t,r){return{next:function(e){try{var n;return Promise.resolve(X((function(){return!n}),void 0,(function(){var o=r.next(e),i=!!o.done,u=o.value;return function(){if(function(t){return t&&!!t[A]}(u)){var r=u.action,o=u.args;return Promise.resolve(r.apply(t,o)).then((function(t){if(e=t,i)return n=1,{done:i,value:e}}))}return n=1,{done:i,value:u}}()})))}catch(o){return Promise.reject(o)}}}}({storage:this.storage,activeTransactions:this.activeTransactions,updateSpaceRefs:this.updateSpaceRefs,spaces:this.spaces},t)},r.transaction=function(t,r,e){try{var n,o=this,i=o.spaces.get(t);if(!i)throw new k(t);e?(n=e,Object.assign({restartOnFail:!1},r)):n=r;var u=new V(o,i);return Promise.resolve(n(u)).then((function(){return o.updateSpaceRefs(t,u.refs),u.getStats()}))}catch(c){return Promise.reject(c)}},r.getFlatChain=function(t,r){void 0===r&&(r=3);try{var e=this;if(!r||!t)return Promise.resolve([]);var n=[],o=[t],i=0,u=X((function(){return i<r&&!!o.length}),(function(){return i++}),(function(){function t(){o=r}var r=[],i=W(o,(function(t){return Promise.resolve(e.storage.loadChunk(t)).then((function(t){n.push(t),r.push.apply(r,t.parents)}))}));return i&&i.then?i.then(t):t()}));return Promise.resolve(u&&u.then?u.then((function(){return n})):n)}catch(c){return Promise.reject(c)}},r.updateSpaceRefs=function(t,r){try{var e=this;return e.spaces.set(t,c({},e.spaces.get(t),{refs:r})),Promise.resolve(e.storage.saveSpace(e.spaces.get(t))).then((function(){var r=e.spaceSubscriptions.get(t);r&&r.forEach((function(t){return t()}))}))}catch(n){return Promise.reject(n)}},t}();var tt=function(){function t(){this.chunks=new Map,this.spaces=new Map}var r=t.prototype;return r.loadChunk=function(t){try{if(this.chunks.has(t))return Promise.resolve(this.chunks.get(t));throw new P(t)}catch(r){return Promise.reject(r)}},r.saveChunk=function(t){try{return this.chunks.set(t.id,t),Promise.resolve(t)}catch(r){return Promise.reject(r)}},r.markDraftChunkAsUnused=function(t){try{return this.chunks.delete(t),Promise.resolve()}catch(r){return Promise.reject(r)}},r.setChunks=function(t){var r=this;t.forEach((function(t){return r.chunks.set(t.id,t)}))},r.clearChunks=function(){try{return this.chunks.clear(),Promise.resolve()}catch(t){return Promise.reject(t)}},r.reset=function(t){this.chunks.clear(),this.setChunks(t)},r.removeChunk=function(t){try{return this.chunks.delete(t),Promise.resolve()}catch(r){return Promise.reject(r)}},r.createSpace=function(t){try{if(this.spaces.has(t.id))throw new b('Can not create space "'+t.id+'": already exists');return this.spaces.set(t.id,t),Promise.resolve(t)}catch(r){return Promise.reject(r)}},r.loadSpace=function(t){try{return Promise.resolve(this.spaces.get(t))}catch(r){return Promise.reject(r)}},r.saveSpace=function(t){try{return this.spaces.set(t.id,t),Promise.resolve(t)}catch(r){return Promise.reject(r)}},r.updateSpace=function(t,r){try{var e=this.spaces.get(t);if(!e)throw new b('Can not update space "'+t+'": not exists');return this.spaces.set(t,c({},e,{refs:r})),Promise.resolve(e)}catch(n){return Promise.reject(n)}},r.clearSpaces=function(){try{return this.spaces.clear(),Promise.resolve()}catch(t){return Promise.reject(t)}},r.getAllSpaces=function(){try{return Promise.resolve(Array.from(this.spaces.values()))}catch(t){return Promise.reject(t)}},t}();r.ChunkDB=Z,r.CollectionConfig=J,r.InMemoryChunkStorage=tt,r.Space=B}}]);